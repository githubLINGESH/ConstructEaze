<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/pent.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/smoothness/jquery-ui.css">

    <style>
        *{
            font-family: Sora, 'Source Sans Pro';
            text-transform: uppercase;
        }
        .att .row{
            margin-bottom: 30px;
        }
        .att h1{
            font-weight: 700;
            font-size: 3rem;
            color: #404040;
        }
        .att h4{
            font-size: 2rem;
            font-weight: bold;
        }
        .att .btn-block{
            font-size: 14px;
            border: 0;
            color: white;
            width:150px;
            height: 40px;
            border-radius: 20px;
            background: #242E82;
            box-shadow: 0px 0px 3px 0.5px rgba(0, 0, 0, 0.25);
        }
        .att i{
            padding-right: 5px;
        }
        .att label{
            padding-right: 10px;
        }
        .att input{
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 14px;
            width: 100px;
            height: 30px;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ccc;
        }
        .att .table-responsive .table {
            max-width: 70%; /* Adjust this value to decrease the width */
            margin: 20px auto; /* Center the table horizontally */
            border-collapse: collapse;
            border: 3px solid #ccc;
            border-radius: 10px;
            font-size: 15px;
            width: 85%;
            size: 50px;
        }
        .att thead th,td{
            padding: 20px 20px 20px 20px !important;
            text-align: center;
            background-color: white;
        }
        .att .table2{
            font-size: 12px !important;
            border-style: none !important;
        }
        .att .table2 th,.table2 td{
            padding: 8px !important;
            text-align: center !important;
        }
        @media (max-width: 767px) {
        .att .form-group {
                margin-bottom: 10px;
            }
            
        }

        /*.att .modal-content {
            border-radius: 15px;
            border-top-left-radius: 20px !important;
            border-top-right-radius: 20px !important;
        }
        .att .modal-header{
            background-color: #242E82;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .att .modal-header h1{
            color: white !important;
        }
        .att .modal-header .close {
            color: white !important;
            font-size: 24px;
            font-weight: bold;
            opacity: 1;
            background-color: transparent; /* Add this line to make the background transparent
            border: none; /* Add this line to remove the border
            outline: none; /* Add this line to remove the outline on focus
            padding: 0; /* Add this line to remove extra padding
        }
        .att .modal-body input{
            width: 300px !important;
            margin-top: 10px !important;
            padding: 5px !important;
            border-radius: 5px !important;
            border: 1px solid #ccc !important;
        }
        .att .date-DU2 {
            box-sizing: border-box;
            padding: 1.1rem 0.2rem 0.9rem 0.2rem;
            width: 30rem;
            height: 40%;
            display: flex;
            justify-content: center ;
            box-shadow: 0 0 0.3rem rgba(0, 0, 0, 0.25);
            background-color: #ffffff;
            border-radius: 1rem;
            flex-shrink: 0;
        }
        .att .date-DU2 .ooui-next-ltr-LoY {
            margin-right: 10px;
            width: 0.624rem;
            height: 1.08rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt {
            margin: 0.7rem 3.1rem 0.9rem 0rem;
            height: calc(100% - 1.6rem);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt .item-13-1en {
            margin: 0rem 0rem 0.2rem 0.3rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt .tue-8UW {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 {
            margin-right: 3.4rem;
            box-sizing: border-box;
            padding: 0.8rem 0.4rem 0.8rem 0.5rem;
            width: 5.5rem;
            height: 7rem;
            background-color: #000000;
            border-radius: 1rem;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA {
            width: 100%;
            height: 100%;
            align-items: center;
            display: flex;
            flex-direction: column;
        }
        .att button{
            outline: none;
            background-color: white;
            border:0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA .item-14-Laa {
            margin: 0rem 0.5rem 0.2rem 0rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #ffffff;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA .wed-TfC {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #ffffff;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ {
            margin: 0.7rem 1.936rem 0.9rem 0rem;
            height: calc(100% - 1.6rem);
            display: flex;
            justify-content: center;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ .item-15-hpS {
            margin: 0rem 0rem 0.2rem 0.5rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ .thu-pu4 {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .ooui-next-ltr-Zre {
            margin-left: -10px;
            width: 0.624rem;
            height: 1.08rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .mon-Lc6 {
            margin: 2.1rem 0rem 0.7rem 0rem;
            margin-left: 10px;
            box-sizing: border-box;
            padding-bottom: 0.24rem;
            height: calc(100% - 2.8rem);
            align-items: center;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .vector-fPU {
            margin: 0rem 0rem 0.9rem 0.1rem;
            width: 2.4rem;
            height: 2.4rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .jun-amL {
            margin-bottom: 0.636rem;
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .ooui-next-ltr-82A {
            margin-left: 0.1rem;
            width: 1.08rem;
            height: 0.624rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }*/
        .btn {
            background-color: white !;
            color: black !important;
            border: 3px solid #F2D200;
            border-radius: 25px;
            font-weight: 400 !important;
        }
        .att .input-group input{
            height: 50px;
            width: 50%;
            padding-left: 10px;
            font-size: 14px;
            border: 1px solid silver;
            border-radius: 5px;
        }
        .att .input-group input:focus{
            border-color: #242E82;
            border-bottom-width: 2px;
        }
        #check{
            margin-right: 6px;
            pointer-events: none;
        }
        #check:checked{
            accent-color: green;
        }

        td .cbx {
        position: relative;
        top: 1px;
        width: 25px;
        height: 25px;
        border: 2px solid #c8ccd4;
        border-radius: 3px;
        align-items: center;
        transition: background 0.1s ease;
        cursor: pointer;
        display: block;
        }

        td .cbx:after {
        content: '';
        position: absolute;
        top: 3px;
        left: 7px;
        width: 7px;
        height: 13px;
        opacity: 0;
        transform: rotate(45deg) scale(0);
        border-right: 2px solid #fff;
        border-bottom: 2px solid #fff;
        transition: all 0.3s ease;
        transition-delay: 0.15s;
        }

        td .lbl {
        margin-left: 10px;
        vertical-align: middle;
        cursor: pointer;
        }

        td #cbx:checked ~ .cbx {
        border-color: transparent;
        background: #6871f1;
        animation: jelly 0.6s ease;
        }

        td #cbx:checked ~ .cbx:after {
        opacity: 1;
        transform: rotate(45deg) scale(1);
        }

        td .cntr {
        position: relative;
        }

        @keyframes jelly {
        from {
        transform: scale(1, 1);
        }

        30% {
        transform: scale(1.25, 0.75);
        }

        40% {
        transform: scale(0.75, 1.25);
        }

        50% {
        transform: scale(1.15, 0.85);
        }

        65% {
        transform: scale(0.95, 1.05);
        }

        75% {
        transform: scale(1.05, 0.95);
        }

        to {
        transform: scale(1, 1);
        }
        }

        .hidden-xs-up {
        display: none !important;
        }
        /* CSS for hiding the attendance column */
        .hidden {
            display: none;
        }
        .popup{
            width: 400px;
            background: #fff;
            border-radius: 6px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%,-50%);
            text-align: center;
            padding: 0 30px 30px;
            color: #333;
        }
        .popup img{
            width: 100px;
            margin-top: -50px;
            border-radius: 50px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .popup h2{
            font-size: 38px;
            font-weight: 500;
            font-family: 'Sora' sans-serif !important;
            margin: 30px 0 10px;
        }
        .popup button{
            width: 100%;
            margin-top: 20px;
            padding: 10px 0;
            background: #242e82;
            color: #fff;
            border: 0;
            outline: none;
            font-size: 18px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 5px 5px rgba(0,0,0,0.2);
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black background */
            }
            
            .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            }
            
            .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            }
            
            .close:hover,
            .close:focus {
            color: black;
            }
                
                .custom-checkbox {
                width: 30px;
                height: 30px;
                background-color: transparent;
                border: 1px solid #ccc;
                border-radius: 5px;
                cursor: pointer;
                position: relative;
                transition: background-color 0.3s, color 0.3s;
                }
                
                .custom-checkbox::after {
                content: '';
                font-size: 20px;
                color: transparent;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                }
                
                .custom-checkbox:active {
                background-color: rgb(200, 255, 0);
                }
                
                .custom-checkbox.clicked {
                background-color: #ff5733; /* New background color */
                color: #000; /* New text color */
                }

        
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid" style="margin: 10px 20px;">
        <a class="navbar-brand" href="#">
            <img src="assets/img/logo.png" alt="Construct Eaze" style="width: 280px;">
        </a>
        <!--<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>-->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0"  style="margin-left: 15%;">
            
            <li class="nav-item">
                <a class="nav-link" href="masnode.html">Master</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#">Labour Management</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" aria-current="page" href="prod.html">Purchase Management</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="todo.html">Site Activity</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="labrep.html">Report Generation</a>
            </li>
            </ul>
            <form class="d-flex" style="padding-left: 190px; padding-top: 5px;">
            <button class="btn" type="submit"><span class="txt">Logout</span></button>
            </form>
        </div>
        </div>
    </nav>

    <div class="row content" style="display: flex; width: 100%; height: 100%;" >
        <div class="col-lg-2">
        <div class="sidebar" style="height: 100%;">
            <nav class="nav flex-column" style="padding-top: 100px; ">
                <a class="nav-link space"  style="color: white !important; background-color: rgba(0, 0, 0, 0.2); border-left: 3px solid #F2D200;" href="#">Attendance</a>
                <a class="nav-link space" id="supervisor" href="superATT.html">Supervisor Attendance</a>
            </nav>
                <button id="loginButton" class="nav-link space" style="color: white !important; background-color: rgba(0, 0, 0, 0.2); border-left: 3px solid #F2D200; font-size:15px; display: none; width: 100%; text-align:left;">SUPERVISOR ATTENDANCE</button>
        </div>
        </div>
        <div class="col-lg-10">
        <div class="att">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"> <h1>daily workers</h1></div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; justify-content: flex-end; ">
                        <!--<button type="button" class="btn-block" data-toggle="modal" data-target="#add_wr">
                            <i class="fas fa-plus"></i>
                            Add Worker
                        </button>
                    </div>-->
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                    <!--<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                        <div class="date-DU2">
                            <button><i class="fas fa-chevron-left"></i></button>
                            <div class="item-13-HTt">
                            <p class="item-13-1en"></p>
                            <p class="tue-8UW"></p>
                            </div>
                            <div class="today-4d4">
                            <div class="item-14-nJA">
                                <p class="item-14-Laa"></p>
                                <p class="wed-TfC"></p>
                            </div>
                            </div>
                            <div class="item-15-BLJ">
                            <p class="item-15-hpS"></p>
                            <p class="thu-pu4"></p>
                            </div>
                            <button><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="mon-Lc6">
                            <button><i class="fas fa-calendar-alt"></i>
                            <p class="jun-amL"></p>
                            <i class="fas fa-chevron-down"></i>
                            </button>
                        </div>
                    </div>-->
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                        <div class="input-group">
                            <div class="input-group-addon" style="background-color: rgb(177, 177, 177);">
                                <button id="search-button" type="button" style="margin: 10px 10px; border: none; background: none;">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <input type="text" name="search" id="search-input" class="form-control" placeholder="Search Labour">
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; justify-content: flex-end; ">
                        <div class="table-responsive">
                            <table class="table2">
                                <thead>
                                    <tr id="workerTypeTableHeader">
                                        <!-- Worker type column headers will be added here dynamically -->
                                    </tr>
                                </thead>
                                <tbody id="workerTypeTableBody">
                                    <!-- Worker type rows will be added here dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!--<div class="row ">
                <form id="attform" action="/contract/submit" method="POST">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 ">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="male">MALE: </label>
                            <input type="text" id="male" required>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="female">FEMALE: </label>
                            <input type="text" id="female" required>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <label for="contract">CONTRACT: </label>
                            <input type="text" id="contract" required>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 form-group">
                            <button type="submit" class="btn-block" id="wrkbtn">Mark Attendance</button>
                        </div>
                    </div>
                </form>
                
            </div>-->

            <div id="successMessage" style="display: none; font: size 30px;">Record inserted successfully!</div>
            <div class="row" >
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                    <button class="btn-block" id="markAttendanceButton" style="margin-left: 20px;">Mark Attendance</button>
                </div>

                
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display:flex; align-items: center">
                    <button class="btn-block" id="SuperATTButton"onclick="MarksuperAtt()" style="margin-right: 10px; background-color: green;">check In</button>
                    <button class="btn-block" id="logoutButton" style="margin-left: 10px; background-color: red;">check out</button>
                </div>




                <!--<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                    <button class="btn-block" id="SuperATTButton" onclick="MarksuperAtt()" style="margin-left: 20px;">Mark My Attendance</button>
                </div>-->

            </div>
            <div class="four">
                <table id="table" class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>WorkerType</th>
                            <th>Shift</th>
                            <th>Wages Per Shift</th>
                            <th>total</th>
                            <th class="hidden">Marked Locations</th>
                        </tr>
                    </thead>
                    <tbody id="tasks-table-body">
                    <!-- labor records are inserted dynamically-->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4">Grand Total</td>
                                <td id="grandTotal">0</td>
                                <td></td>
                            </tr>
                        </tfoot>
                </table>
            </div>
            <div id="add_wr" class="modal fade" role="form">
                <div class="modal-dialog">
            
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">cancel</button>
                    
                    <h1 class="modal-title" style="text-transform: uppercase;">add worker</h1>
                    </div>
                    <div class="modal-body">
                        <h4 style="margin-top: 10px;">WORKER DETAILS</h4>
                        <form id="workerContractForm" method="POST" action="/contract/submit">
                            <input type="text" placeholder="Name of the Worker" name="w_name" required><br>
                            <input type="number" placeholder="Phone Number" name="phone" required><br>
                            <input type="text" placeholder="Worker Type" name="w_type" required><br>
                            <input type="number" placeholder="Salary Per Shift (Rs.)" name="sal" required><br>
                            <input type="number" placeholder="Hours Per Shift" name="shift" required><br>
                            <h2 style="margin-top: 10px;">CONTRACT DETAILS</h2>
                            <input type="date" placeholder="Start Date" name="start" required><br>
                            <input type="date" placeholder="End Date" name="end" required><br>
                            <div class="modal-footer">
                            <button id="addButton" type="submit" class="btn btn-default" data-dismiss="modal">Add</button>
                            </div>
                        </form>
                    </div>
                </div>
                </div>
            </div>
        </div>
        </div>
        </div>


    </div>
    <div id="myModal" class="modal">
        <div class="popup">
            <img src="assets/img/succs.png">
            <h2>Attendance</h2>
            <p>Attendance Marked successfully!</p>
            <button onclick="closeModal()">OK</button>
        </div>
    </div>
    <div id="myModal1" class="modal">
        <div class="popup">
            <img src="assets/img/succs.png">
            <h2>Attendance</h2>
            <p>Supervisor Attendance Marked successfully!</p>
            <button onclick="closeModal1()">OK</button>
        </div>
    </div>
    <script>
        function openModal() {
            const modal = document.getElementById("myModal");
            modal.style.display = "block";
        }

        function closeModal() {
            const modal = document.getElementById("myModal");
            modal.style.display = "none";
        }

        function openModal1() {
            const modal1 = document.getElementById("myModal1");
            modal1.style.display = "block";
        }

        function closeModal1() {
            const modal1 = document.getElementById("myModal1");
            modal1.style.display = "none";
        }
    </script>
        
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loginButton = document.getElementById('loginButton');
            const attendanceColumn = document.getElementById('attendanceColumn');
        
            loginButton.addEventListener('click', function () {
                // Toggle the visibility of the attendance column
                attendanceColumn.classList.toggle('hidden');
            });
        });
    </script>
    <script>

        let modifiedShiftValue;

        const contractForm = document.getElementById('contractForm');
        const workerContractForm = document.getElementById('workerContractForm');
        const addButton = document.getElementById('addButton');
        const successMessage = document.getElementById('successMessage');

        const tasksTableBody = document.querySelector('#table tbody');
        const handleCheckboxClick = (event) => {
            const target = event.target;
            
            if (target.type === 'checkbox') {
                // Handle checkbox click
                const row = target.closest('tr');
                const workerId = row.querySelector('.w_id').dataset.workerId;
                const status = target.checked ? 'Present' : 'Absent';
                markAttendance(workerId, status);
                submitRecord(workerId,status);
            }
        };
        
        async function MarksuperAtt(){
        // Assuming you have your button element with the id "SuperATTButton"
        const superAttButton = document.getElementById('SuperATTButton');

        function getPreciseLocation() {
            return new Promise((resolve, reject) => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(resolve, reject);
                } else {
                    reject(new Error('Geolocation is not available.'));
                }
            });
        }
    
        const position = await getPreciseLocation(); // Wait for location data
    
        const SattendanceData = {
            status : 'Present',
            latitude: position.coords.latitude,
            longitude: position.coords.longitude,
        };

        superAttButton.addEventListener('click', async () => {
        try {
            const response = await fetch('/sAtt/superAtt', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(SattendanceData),
            });

            if (response.ok) {
            const data = await response.json();
            openModal1();
            console.log(data);
            } else {
            console.error('Error marking supervisor attendance:', response.statusText);
            }
        } catch (error) {
            console.error('Error marking supervisor attendance:', error);
            
        }
        });

        }

        function submitModifiedRecord(workerID, status, buttonElement) {
            // Capture the modified shift value
            const row = buttonElement.closest('tr');
            const modifiedShift = row.querySelector('.shift').textContent;
        
            // Call the submitRecord function with the modified shift value
            submitRecord(workerID, status, modifiedShift);
        }
        
            // Assuming you have an empty table with an ID "tasksTable"
            //geolocation getting fns
            function createGoogleMapsLink(latitude, longitude) {
                const mapUrl = `https://maps.google.com/maps?q=${latitude},${longitude}`;
                const link = document.createElement('a');
                link.href = mapUrl;
                link.target = '_blank';
                link.textContent = 'View on Google Maps';
                return link;
                }
            
            // Function to fetch and display worker records
            const fetchAndDisplayTasks = (searchQuery) => {
                // Create an object to hold query parameters
                const queryParams = {};
            
                if (searchQuery) {
                    // If there is a search query, add it to the query parameters
                    queryParams.search = searchQuery;
                }
            
                // Construct the query string with the query parameters
                const queryString = new URLSearchParams(queryParams).toString();
                fetch(`/contract/det?${queryString}`)
                .then(response => response.json())
                .then(data => {
                    
                    const tasks = data.tasks;
                    const userRole = data.role; // Get the user's role from the response

                    const absBut = document.getElementById('logoutButton');

                    if(userRole == 'Engineer')
                    {
                        absBut.style.display ='none';
                    }

                    const superAttButton = document.getElementById('SuperATTButton');

                    if(userRole == 'Engineer'){
                        superAttButton.style.display = 'none';
                    }

                    const supervisorAtt = document.getElementById('supervisor');

                    if(userRole == 'Supervisor')
                    {
                        supervisorAtt.style.display = 'none';
                    }
            
                    const loginButton = document.getElementById('loginButton');

                        // Check the user's role and hide the login button if it's not "engineer"
                        if (userRole !== 'Engineer') {
                        loginButton.style.display = 'none';
                        }

                    tasks.forEach(task => {
                        // Check if a row with the same w_name already exists
                        const existingRow = tasksTableBody.querySelector(`[data-worker-id="${task.w_name}"]`);

                        if (!existingRow) {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${task.w_name}</td>
                                <td>${task.w_type}</td>
                                <td class="shift" data-shift="${task.shift}">${task.shift}</td>
                                <td class="cntr" style="display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    margin-right: 30px;">
                                    <input style="box-shadow:none; width: 20px;
                                        height: 20px;
                                        background-color: #007bff;
                                        border: 1px solid #007bff;"
                                        type="checkbox"
                                        checked
                                        ${task.pa !== 'Present' ? 'disabled' : 'checked'}> <!-- Initially checked if task.pa is 'Present', disabled if not -->
                                </td>
                                <td>${task.sal}</td>
                                <td>${task.total}</td>
                                <td class="google-maps-link"></td>
                                <td class="joker">${task.name}</td>
                                <td><button onclick="submitModifiedRecord('${task.w_name}', 'Present', this)" type="button" style="display: flex; background-color: #007bff; border: 8px solid #007bff;">submit</button></td>
                                <td class="w_id" data-worker-id="${task.w_name}" style="display: none;">${task.w_name}</td>
                            `;
        
                            // Append the new row to the end of the table
                            tasksTableBody.appendChild(row);

                            const shiftField = row.querySelector('.shift');
                            shiftField.addEventListener('click', () => {
                                shiftField.setAttribute('contenteditable', 'true');
                                shiftField.focus();
                            });
                    
                            // Add a blur event listener to capture the modified "shift" value when it loses focus
                            shiftField.addEventListener('blur', () => {
                                const modifiedShift = shiftField.textContent;
                                shiftField.setAttribute('data-shift', modifiedShift);
                                shiftField.removeAttribute('contenteditable');
                            });

                            const cntr=row.querySelector('.cntr');

                                
                            cntr.style.display = 'none';
                            const googleMapsLinkContainer = row.querySelector('.google-maps-link');
                            const jokerid = row.querySelector('.joker');
        
                            // Create and add the Google Maps link to the container
                            const googleMapsLink = createGoogleMapsLink(task.latitude, task.longitude);
                            googleMapsLinkContainer.appendChild(googleMapsLink);
                            if (userRole !== 'Engineer') {
                                googleMapsLinkContainer.style.display = 'none';
                            }

                            if (userRole !== 'Engineer') {
                                jokerid.style.display = 'none';
                            }
                        } else {
                            // Display a message indicating that the worker is already in the table
                            console.log(`Worker ${task.w_name} is already in the table.`);
                        }

                        });
                        
                        // Define the markAttendance function at the global scope
                        const markAttendance = async (attendanceArray) => {

                            for (const attendance of attendanceArray) {


                            const {workerID, status, shift, latitude, longitude} = attendance;


                            const currentDate = new Date();
                            const year = currentDate.getFullYear();
                            const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                            const day = currentDate.getDate().toString().padStart(2, '0');
                            const formattedDate = `${year}-${month}-${day}`;

                            

                            const date = formattedDate;

                            const data = {
                                date,
                                workerID,
                                status,
                                shift,
                                latitude,
                                longitude
                                };

                            try {
                                const response = await fetch('/contract/markAttendance', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify(data),
                                });

                                if (response.ok) {
                                    const result = await response.json();
                                    // Handle the response if needed
                                    openModal();
                                    console.log(result);
                                } else {
                                    // Handle the case where the POST request was not successful
                                    console.error('Error marking attendance:', response.statusText);
                                }
                            } catch (error) {
                                // Handle any errors that occurred during the fetch or processing
                                console.error('Error marking attendance:', error);
                            }
                        };
                    };

                        // Add an event listener to the "Mark Attendance" button
                        const markAttendanceButton = document.getElementById('markAttendanceButton');


                        if (!markAttendanceButton.hasEventListener) {
                            markAttendanceButton.hasEventListener = true;
                        markAttendanceButton.addEventListener('click', async () => {
                            const position = await getPreciseLocation(); // Wait for location data
                            // Find all checkboxes
                            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                            
                            // Create an array to store the attendance data for each worker
                            const attendanceData = [];
                            
                            checkboxes.forEach(checkbox => {
                                // Get the worker ID from the data attribute
                                const workerID = checkbox.closest('tr').querySelector('.w_id').getAttribute('data-worker-id');
                                
                                // Determine the status based on checkbox checked state
                                const status = checkbox.checked ? 'Present' : 'Absent';

                                const modifiedShift = checkbox.closest('tr').querySelector('.shift').getAttribute('data-shift');
                                console.log(modifiedShift);
                                
                                // Call the markAttendance function with location data to send the data to the server
                                attendanceData.push({
                                    workerID,
                                    status,
                                    shift:modifiedShift,
                                    latitude: position.coords.latitude,
                                    longitude: position.coords.longitude,
                                    });
                            });
                            markAttendance(attendanceData);
                        });
                    }

                    // Modify the getPreciseLocation function to return a Promise
                    function getPreciseLocation() {
                        return new Promise((resolve, reject) => {
                            if (navigator.geolocation) {
                                navigator.geolocation.getCurrentPosition(resolve, reject);
                            } else {
                                reject(new Error('Geolocation is not available.'));
                            }
                        });
                    }
                    });
            };
            fetchAndDisplayTasks();
            


            async function submitRecord(workerID, status , shift) {
                // Prompt the user to confirm before submitting for a specific record
                const confirmation = confirm(`Submit record for Worker ID: ${workerID} as ${status} with shift: ${shift}?`);

                if (!shift) {
                    shift = modifiedShiftValue;
                }

                if (!confirmation) {
                    return;
                }
            
                // Send a request to mark attendance for the specific record
                const currentDate = new Date();
                const year = currentDate.getFullYear();
                const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                const day = currentDate.getDate().toString().padStart(2, '0');
                const formattedDate = `${year}-${month}-${day}`;

                function getPreciseLocation() {
                    return new Promise((resolve, reject) => {
                        if (navigator.geolocation) {
                            navigator.geolocation.getCurrentPosition(resolve, reject);
                        } else {
                            reject(new Error('Geolocation is not available.'));
                        }
                    });
                }
            
                const position = await getPreciseLocation(); // Wait for location data
            
                const attendanceDataa = {
                    date: formattedDate,
                    workerID,
                    status,
                    shift:shift || modifiedShiftValue,
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                };
            
                fetch('/contract/markAttendanceForRecord', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(attendanceDataa),
                })
                .then(response => response.json())
                .then(result => {
                    // Handle the response if needed
                    openModal();
                    console.log(result);
                    fetchAndDisplayTasks(); // Refresh the table after marking attendance
                })
                .catch(error => {
                    // Handle any errors that occurred during the fetch or processing
                    console.error('Error marking attendance for record:', error);
                });
            }

            // Function to handle the search input and trigger fetching and displaying tasks
            const handleSearch = () => {
                const searchInput = document.getElementById('search-input');
                
                const searchQuery = searchInput.value.trim();

                if (searchQuery !== '') {
                    fetchAndDisplayTasks(searchQuery);
                }
            };


            const handleSearchh = () => {
                const searchButton = document.getElementById('search-button');
                
                const searchQuery = searchInput.value.trim();

                if (searchQuery !== '') {
                    fetchAndDisplayTasks(searchQuery);
                }
            };

            // Event listener for the Enter key in the search input
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    handleSearch();
                }
            });
            

            const searchButton = document.getElementById('search-button');

            searchButton.addEventListener('click', function() {
                const searchValue = searchInput.value.trim();
                handleSearchh();
            });
            



    </script>
    <script>
        $(function() {
            $("#search-input").autocomplete({
                source: function(request, response) {
                    // Make an AJAX request to fetch autocomplete suggestions
                    $.ajax({
                        url: '/contract/autocomple', // URL to fetch autocomplete suggestions
                        method: 'GET', // Use GET request
                        dataType: 'json', // Expect JSON response
                        data: {
                            term: request.term // Pass the user input as 'term'
                        },
                        success: function(data) {
                            response(data); // Provide the response to the autocomplete widget
                        },
                        error: function(error) {
                            console.error('Error fetching autocomplete suggestions:', error);
                        }
                    });
                },
                minLength: 0, // Minimum number of characters before showing suggestions
                select: function(event, ui) {
                    // Handle selected item
                    $("#search-input").val(ui.item.value);
                    // Perform search based on the selected value
                    searchTasks(ui.item.value);
                }
            });
        });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
    // Attach a click event listener to the table element
    document.querySelector('#table tbody').addEventListener('click', (event) => {
        if (event.target.type === 'checkbox') {
            const checkbox = event.target;
            const isChecked = checkbox.checked;
            
            // Find the associated worker's name
            const row = checkbox.closest('tr');
            const workerName = row.querySelector('.w_id').textContent;
            
            // Now you can use the workerName and isChecked as needed
            if (isChecked) {
                // Handle when the checkbox is checked
                console.log(`Checkbox for ${workerName} is checked.`);
                // Add your logic here for when the checkbox is checked
            } else {
                // Handle when the checkbox is unchecked
                console.log(`Checkbox for ${workerName} is unchecked.`);
                // Add your logic here for when the checkbox is unchecked
            }
        }
    });
});

    </script>
    <script>
        function fetchAndUpdateworkertypeCounts() {
            fetch('/contract/getworkertype-count')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(workerTypeCounts => {
                const workerTypeTableHeader = document.getElementById('workerTypeTableHeader');
                const workerTypeTableBody = document.getElementById('workerTypeTableBody');
        
                // Clear existing table content
                workerTypeTableHeader.innerHTML = '';
                workerTypeTableBody.innerHTML = '';
        
                // Check if data is empty
                if (Object.keys(workerTypeCounts).length === 0) {
                    const noDataMessage = document.createElement('p');
                    noDataMessage.textContent = 'No data available.';
                    workerTypeTableBody.appendChild(noDataMessage);
                    return;
                }
        
                // Create column headers
                const headerRow = document.createElement('tr');
                for (const workerType in workerTypeCounts) {
                    const headerCell = document.createElement('th');
                    headerCell.textContent = workerType;
                    headerRow.appendChild(headerCell);
                }
                workerTypeTableHeader.appendChild(headerRow);
        
                // Create count rows
                const countRow = document.createElement('tr');
                for (const workerType in workerTypeCounts) {
                    const count = workerTypeCounts[workerType];
                    const countCell = document.createElement('td');
                    countCell.textContent = count;
                    countRow.appendChild(countCell);
                }
                workerTypeTableBody.appendChild(countRow);
            })
            .catch(error => {
                console.error('Error fetching counts:', error);
                const errorContainer = document.getElementById('errorContainer');
                errorContainer.textContent = 'Error fetching data. Please try again later.';
            });
        }
        
        // Call the function when needed, e.g., when the page loads or after marking attendance
        fetchAndUpdateworkertypeCounts();

        // Function to fetch the total from the server and update the Grand Total in the table
const updateGrandTotal = () => {
    fetch('/contract/totalwagesperday') // Replace with the actual endpoint on your server
        .then(response => response.json())
        .then(data => {
            const grandTotalValue = data.total; // Assuming your server responds with an object that has a 'total' property
            const grandTotalCell = document.getElementById('grandTotal');
            grandTotalCell.textContent = grandTotalValue;
        })
        .catch(error => {
            console.error('Error fetching grand total:', error);
        });
};

// Call the updateGrandTotal function to fetch and display the total when needed
updateGrandTotal();


// Async function to handle supervisor logout
async function handleSupervisorLogout() {
    try {
        const date = new Date();

        // Send an HTTP request to update the logout_t time
        const response = await fetch('/sAtt/logout', {
            method: 'PUT', // You can use PUT or POST based on your API
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                logout_t: date.toISOString(), // Convert the date to ISO format for the server
            }),
        });

        if (response.ok) {
            // Logout successful, you can do any client-side operations here
            console.log('Logout successful');
        } else {
            // Handle errors if needed
            console.error('Error logging out');
        }
    } catch (error) {
        console.error('Error logging out:', error);
        // Handle errors if needed
    }
}

// Add an event listener to the logout button to call the function
document.getElementById('logoutButton').addEventListener('click', handleSupervisorLogout);


    
    </script>
</body>
</html>

