<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/pent.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">


    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <style>
        *{
            font-family: Sora, 'Source Sans Pro';
            text-transform: uppercase;
        }
        .att .row{
            margin-bottom: 30px;
        }
        .att h1{
            font-weight: 700;
            font-size: 3rem;
            color: #404040;
        }
        .att h4{
            font-size: 2rem;
            font-weight: bold;
        }
        .att .btn-block{
            font-size: 14px;
            border: 0;
            color: white;
            width:150px;
            height: 40px;
            border-radius: 20px;
            background: #242E82;
            box-shadow: 0px 0px 3px 0.5px rgba(0, 0, 0, 0.25);
        }
        .att i{
            padding-right: 5px;
        }
        .att label{
            padding-right: 10px;
        }
        .att .table-responsive .table {
            max-width: 70%; /* Adjust this value to decrease the width */
            margin: 20px auto; /* Center the table horizontally */
            border-collapse: collapse;
            border: 3px solid #ccc;
            border-radius: 10px;
            font-size: 15px;
            width: 85%;
            size: 50px;
        }
        .att thead th,td{
            padding: 20px 20px 20px 20px !important;
            text-align: center;
            background-color: white;
        }
        .att .table2{
            font-size: 12px !important;
            border-style: none !important;
        }
        .att .table2 th,.table2 td{
            padding: 8px !important;
            text-align: center !important;
        }
        @media (max-width: 767px) {
        .att .form-group {
                margin-bottom: 10px;
            }
            
        }
       
        /*.att .modal-content {
            border-radius: 15px;
            border-top-left-radius: 20px !important;
            border-top-right-radius: 20px !important;
        }
        .att .modal-header{
            background-color: #242E82;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .att .modal-header h1{
            color: white !important;
        }
        .att .modal-header .close {
            color: white !important;
            font-size: 24px;
            font-weight: bold;
            opacity: 1;
            background-color: transparent; /* Add this line to make the background transparent 
            border: none; Add this line to remove the border 
            outline: none; Add this line to remove the outline on focus 
            padding: 0; Add this line to remove extra padding 
        }
        .att .modal-body input{
            width: 300px !important;
            margin-top: 10px !important;
            padding: 5px !important;
            border-radius: 5px !important;
            border: 1px solid #ccc !important;
        }
        .att .date-DU2 {
            box-sizing: border-box;
            padding: 1.1rem 0.2rem 0.9rem 0.2rem;
            width: 30rem;
            height: 40%;
            display: flex;
            justify-content: center ;
            box-shadow: 0 0 0.3rem rgba(0, 0, 0, 0.25);
            background-color: #ffffff;
            border-radius: 1rem;
            flex-shrink: 0;
        }
        .att .date-DU2 .ooui-next-ltr-LoY {
            margin-right: 10px;
            width: 0.624rem;
            height: 1.08rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt {
            margin: 0.7rem 3.1rem 0.9rem 0rem;
            height: calc(100% - 1.6rem);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt .item-13-1en {
            margin: 0rem 0rem 0.2rem 0.3rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-13-HTt .tue-8UW {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 {
            margin-right: 3.4rem;
            box-sizing: border-box;
            padding: 0.8rem 0.4rem 0.8rem 0.5rem;
            width: 5.5rem;
            height: 7rem;
            background-color: #000000;
            border-radius: 1rem;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA {
            width: 100%;
            height: 100%;
            align-items: center;
            display: flex;
            flex-direction: column;
        }
        .att button{
            outline: none;
            background-color: white;
            border:0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA .item-14-Laa {
            margin: 0rem 0.5rem 0.2rem 0rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #ffffff;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .today-4d4 .item-14-nJA .wed-TfC {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #ffffff;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ {
            margin: 0.7rem 1.936rem 0.9rem 0rem;
            height: calc(100% - 1.6rem);
            display: flex;
            justify-content: center;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ .item-15-hpS {
            margin: 0rem 0rem 0.2rem 0.5rem;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .item-15-BLJ .thu-pu4 {
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .date-DU2 .ooui-next-ltr-Zre {
            margin-left: -10px;
            width: 0.624rem;
            height: 1.08rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .mon-Lc6 {
            margin: 2.1rem 0rem 0.7rem 0rem;
            margin-left: 10px;
            box-sizing: border-box;
            padding-bottom: 0.24rem;
            height: calc(100% - 2.8rem);
            align-items: center;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .vector-fPU {
            margin: 0rem 0rem 0.9rem 0.1rem;
            width: 2.4rem;
            height: 2.4rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .jun-amL {
            margin-bottom: 0.636rem;
            font-size: 1.8rem;
            font-weight: 400;
            line-height: 1.26;
            color: #000000;
            font-family: Sora, 'Source Sans Pro';
            white-space: nowrap;
            flex-shrink: 0;
        }
        .att .mon-Lc6 .ooui-next-ltr-82A {
            margin-left: 0.1rem;
            width: 1.08rem;
            height: 0.624rem;
            object-fit: contain;
            vertical-align: top;
            flex-shrink: 0;
        } */
        .btn {
            background-color: white !;
            color: black !important;
            border: 3px solid #F2D200;
            border-radius: 25px;
            font-weight: 400 !important;
        }
        .att .input-group input{
            height: 50px;
            width: 50%;
            padding-left: 10px;
            font-size: 14px;
            border: 1px solid silver;
            border-radius: 5px;
        }
        .att .input-group input:focus{
            border-color: #242E82;
            border-bottom-width: 2px;
        }
        #check{
            margin-right: 6px;
            pointer-events: none;
        }
        #check:checked{
            accent-color: green;
        }

        td .cbx {
        position: relative;
        top: 1px;
        width: 25px;
        height: 25px;
        border: 2px solid #c8ccd4;
        border-radius: 3px;
        align-items: center;
        transition: background 0.1s ease;
        cursor: pointer;
        display: block;
        }

        td .cbx:after {
        content: '';
        position: absolute;
        top: 3px;
        left: 7px;
        width: 7px;
        height: 13px;
        opacity: 0;
        transform: rotate(45deg) scale(0);
        border-right: 2px solid #fff;
        border-bottom: 2px solid #fff;
        transition: all 0.3s ease;
        transition-delay: 0.15s;
        }

        td .lbl {
        margin-left: 10px;
        vertical-align: middle;
        cursor: pointer;
        }

        td #cbx:checked ~ .cbx {
        border-color: transparent;
        background: #6871f1;
        animation: jelly 0.6s ease;
        }

        td #cbx:checked ~ .cbx:after {
        opacity: 1;
        transform: rotate(45deg) scale(1);
        }

        td .cntr {
        position: relative;
        }

        @keyframes jelly {
        from {
        transform: scale(1, 1);
        }

        30% {
        transform: scale(1.25, 0.75);
        }

        40% {
        transform: scale(0.75, 1.25);
        }

        50% {
        transform: scale(1.15, 0.85);
        }

        65% {
        transform: scale(0.95, 1.05);
        }

        75% {
        transform: scale(1.05, 0.95);
        }

        to {
        transform: scale(1, 1);
        }
        }

        .hidden-xs-up {
        display: none !important;
        }

    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid" style="margin: 10px 20px;">
        <ul class="nav navbar-nav navbar-left">
            <li><a class="navbar-brand" href="#">
                <img src="assets/img/logo.png" alt="Construct Eaze" style="width: 280px;">
            </a></li>
        </ul>
        <!-- <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button> -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0"  style="margin-left: 15%;">
            
            <li class="nav-item">
                <a class="nav-link" href="masnode.html">Master</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#">Labour Management</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" aria-current="page" href="prod.html">Vendor Management</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="todo.html">Site Activity</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="labrep.html">Report Generation</a>
            </li></ul>
            <ul class="nav navbar-nav navbar-right">
                <li><button class="btn" type="submit"><span class="txt">Logout</span></button></li>
            </ul>
        </div>
        </div>
    </nav>

    <div class="row content" style="display: flex; width: 100%; height: 100%;" >
        <div class="col-lg-2">
        <div class="sidebar" style="height: 100%;">
            <nav class="nav flex-column" style="padding-top: 100px; ">
                <a class="nav-link space"  style="color: white !important; background-color: rgba(0, 0, 0, 0.2); border-left: 3px solid #F2D200;" href="#">Attendance</a>
            </nav>
        </div>
        </div>
        <div class="col-lg-10">
        <div class="att">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"> <h1>daily workers</h1></div>
                    <!-- <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; justify-content: flex-end; ">
                        <button type="button" class="btn-block" data-toggle="modal" data-target="#add_wr">
                            <i class="fas fa-plus"></i>
                            Add Worker
                        </button>
                    </div> -->
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                <!--<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                        <div class="date-DU2">
                            <button><i class="fas fa-chevron-left"></i></button>
                            <div class="item-13-HTt">
                            <p class="item-13-1en"></p>
                            <p class="tue-8UW"></p>
                            </div>
                            <div class="today-4d4">
                            <div class="item-14-nJA">
                                <p class="item-14-Laa"></p>
                                <p class="wed-TfC"></p>
                            </div>
                            </div>
                            <div class="item-15-BLJ">
                            <p class="item-15-hpS"></p>
                            <p class="thu-pu4"></p>
                            </div>
                            <button><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="mon-Lc6">
                            <button><i class="fas fa-calendar-alt"></i>
                            <p class="jun-amL"></p>
                            <i class="fas fa-chevron-down"></i>
                            </button>
                        </div>
                    </div> -->
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                        <div class="input-group">
                            <div class="input-group-addon" style="background-color: rgb(177, 177, 177);">
                                <button type="button" style="margin: 10px 10px; border: none; background: none;">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <input type="text" name="search" id="search-input" class="form-control" placeholder="Search Labour">
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; justify-content: flex-end; ">
                        <div class="table-responsive">
                            <table class="table2">
                                <thead>
                                    <tr>
                                    <th>Present</th>
                                    <th>Absent</th>
                                    <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="prs"></td>
                                        <td class="abs"></td>
                                        <td class="tot"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="successMessage" style="display: none; font: size 30px;">Record inserted successfully!</div>
            <div class="row" >
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" style="display: flex; align-items: center;">
                    <button class="btn-block" style="margin-left: 20px;">Mark Attendance</button>
                </div>
            </div>
            <div class="four">
                <table id="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>WorkerType</th>
                            <th>Shift</th>
                            <th>Present/Absent</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>${task.w_name}</td>
                            <td>${task.w_type}</td>
                            <td>${task.shift}</td>
                            <td class="cntr" style="display: flex;
                            justify-content: center;
                            align-items: center;
                            margin-right: 30px;">
                                <input  type="checkbox" id="cbx" class="hidden-xs-up">
                                <label for="cbx" class="cbx"></label>
                            </td>
                            <td class="w_id" data-worker-id="${task.w_name}" style="display: none;">${task.w_name}</td>
                    </tr>
                    </tbody>
                </table>
            </div>


            <!-- <div id="add_wr" class="modal fade" role="form">
                <div class="modal-dialog">
            
                Modal content
                <div class="modal-content">
                    <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">cancel</button>
                    
                    <h1 class="modal-title" style="text-transform: uppercase;">add worker</h1>
                    </div>
                    <div class="modal-body">
                        <h4 style="margin-top: 10px;">WORKER DETAILS</h4>
                        <form id="workerContractForm" method="POST" action="/contract/submit">
                            <input type="text" placeholder="Name of the Worker" name="w_name" required><br>
                            <input type="number" placeholder="Phone Number" name="phone" required><br>
                            <input type="text" placeholder="Worker Type" name="w_type" required><br>
                            <input type="number" placeholder="Salary Per Shift (Rs.)" name="sal" required><br>
                            <input type="number" placeholder="Hours Per Shift" name="shift" required><br>
                            <h2 style="margin-top: 10px;">CONTRACT DETAILS</h2>
                            <input type="date" placeholder="Start Date" name="start" required><br>
                            <input type="date" placeholder="End Date" name="end" required><br>
                            <div class="modal-footer">
                            <button id="addButton" type="submit" class="btn btn-default" data-dismiss="modal">Add</button>
                            </div>
                        </form>
                    </div>
                </div>
                </div>
            </div> -->
        </div>
        </div>
        </div>
        

    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {

        let date_n = document.querySelector(".item-14-Laa");
        let day_n = document.querySelector(".wed-TfC");
        let date_p = document.querySelector(".item-13-1en");
        let day_p = document.querySelector(".tue-8UW");
        let date_a = document.querySelector(".item-15-hpS");
        let day_a = document.querySelector(".thu-pu4");
        let mon_n = document.querySelector(".jun-amL");
        let crtdte = new Date();
        let date = crtdte.getDate();
        let day = crtdte.getDay();
        let days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        let day_f = days[day];
        let dayp = days[day - 1];
        let daya = days[day + 1];
        let mon = crtdte.getMonth();
        let mons = ['Jan', 'Feb', 'Mar', 'April', 'May', 'June', 'July', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        let mon_f = mons[mon];
        let yr = crtdte.getFullYear();
        console.log(mon);
        date_n.textContent = `${date}`;
        day_n.textContent = `${day_f}`;
        date_p.textContent = `${date - 1}`;
        day_p.textContent = `${dayp}`;
        date_a.textContent = `${date + 1}`;
        day_a.textContent = `${daya}`;
        mon_n.textContent = `${mon_f}`


        const mark = document.getElementById('wrkbtn');

        mark.addEventListener('click', function () {
            let male = parseInt(document.getElementById('male').value);
            let fmale = parseInt(document.getElementById('female').value);
            let cont = parseInt(document.getElementById('contract').value);

            if (isNaN(male)) {
                male = 0;
            }
            if (isNaN(fmale)) {
                fmale = 0;
            }
            if (isNaN(cont)) {
                cont = 0;
            }
            const ct_t = male + fmale + cont;
            const ct_p = male + fmale + cont;
            const tot = document.getElementById('tot');
            tot.textContent = ct_t;
            const prs = document.getElementById('prs');
            prs.textContent = ct_p;
            const abs = document.getElementById('abs');
            abs.textContent = "0";

            document.getElementById('attform').reset();
        });
        });
    </script>
    <script>
        const contractForm = document.getElementById('contractForm');
        const workerContractForm = document.getElementById('workerContractForm');
        const addButton = document.getElementById('addButton');
        const successMessage = document.getElementById('successMessage');

        addButton.addEventListener('click', function (event) {

            // Submit the workerContractForm programmatically
            workerContractForm.submit();
        });

        workerContractForm.addEventListener('submit', function (event) {
            

            const formData = new FormData(workerContractForm);
            const taskData = {
                w_name: formData.get('w_name'),
                phone: formData.get('phone'),
                w_type: formData.get('w_type'),
                sal: formData.get('sal'),
                shift: formData.get('shift'),
                start: formData.get('start'),
                end: formData.get('end')
            };

            fetch('/contract/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(taskData)
            })
                .then(response => {
                    if (response.ok) {
                        console.log('Record inserted successfully.');
                        workerContractForm.reset();
                        // Show the success message
                        successMessage.style.display = 'block';
                        // Hide the message after a few seconds
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 3000);
                    } else {
                        console.error('Error inserting record.');
                    }
                })
                .catch(error => console.error('Error inserting record:', error));
        });
        const tasksTableBody = document.querySelector('#table tbody');

        const handleButtonClick = (event) => {
            const target = event.target;
            if (target.classList.contains('prs')) {
                // Handle Present button click
                const row = target.closest('tr');
                const workerId = row.querySelector('.w_id').dataset.workerId;
                markAttendance(workerId, 'Present');
            } else if (target.classList.contains('abs')) {
                // Handle Absent button click
                const row = target.closest('tr');
                const workerId = row.querySelector('.w_id').dataset.workerId;
                markAttendance(workerId, 'Absent');
            }
        };
    
        const editAttendance = (cell) => {
            toggleButtons(cell, false); // Show "Present" and "Absent" buttons and hide "Edit" button
            // Add event listeners to the "Present" and "Absent" buttons in the editing state
            const presentButton = cell.querySelector('.prs');
            const absentButton = cell.querySelector('.abs');
    
            presentButton.addEventListener('click', () => markWorkerAttendance(cell, 'Present'));
            absentButton.addEventListener('click', () => markWorkerAttendance(cell, 'Absent'));
        };
    
        const toggleButtons = (cell, editing) => {
            const presentButton = cell.querySelector('.prs');
            const absentButton = cell.querySelector('.abs');
            const editButton = cell.querySelector('.edit-btn');
    
            if (editing) {
                presentButton.style.display = 'none';
                absentButton.style.display = 'none';
                editButton.style.display = 'inline-block';
            } else {
                presentButton.style.display = 'inline-block';
                absentButton.style.display = 'inline-block';
                editButton.style.display = 'none';
            }
        };
    
            function markAttendance(workerID, status) {
                const data = { workerID, status };
            
                fetch('/contract/markAttendance', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
                })
                .then((response) => response.json())
                .then((result) => {
                    // Handle the response if needed
                    console.log(result);

                })
                .catch((error) => {
                    // Handle any errors that occurred during the fetch or processing
                    console.error('Error marking attendance:', error);
                });
            }
        
        const fetchAndDisplayTasks = () => {
            fetch('/contract/det')
                .then(response => response.json())
                .then(tasks => {
                    tasksTableBody.innerHTML = ''; // Clear existing table rows
    
                    tasks.forEach(task => {
                        const row = document.createElement('tr');
                        // Modify the row.innerHTML as follows:
                        row.innerHTML = `
                        <td>${task.w_name}</td>
                        <td>${task.w_type}</td>
                        <td>${task.shift}</td>
                        <td class="attendance">
                            ${
                                task.pa === 'Present' ? `<div class="p_a">Present</div>` :
                                task.pa === 'Absent' ? `<div class="p_a">Absent</div>` :
                                `<div class="p_a">
                                    <button class="prs" style="margin-right: 10px; background-color: green;">Present</button>
                                    <button class="abs" style="margin-left: 10px; background-color: red;">Absent</button>
                                </div>`
                            }
                            <button class="edit-btn" style="background-color: rgb(194, 194, 187); display: none;">Edit</button>
                        </td>
                        <td class="w_id" data-worker-id="${task.w_name}" style="display: none;">${task.w_name}</td>
                        `;
                        tasksTableBody.appendChild(row);
                    });
    
                   // Add event listeners to the "Present" and "Absent" buttons
                    const attendanceCells = document.querySelectorAll('.attendance');
                    attendanceCells.forEach((cell) => {
                    const presentButton = cell.querySelector('.prs');
                    const absentButton = cell.querySelector('.abs');
                    const editButton = cell.querySelector('.edit-btn');

                    const markAttendanceHandler = () => {
                        const status = presentButton.style.display === 'none' ? 'Absent' : 'Present';
                        markAttendance(cell.dataset.workerId, status);
                    };

                    presentButton.addEventListener('click', markAttendanceHandler);
                    absentButton.addEventListener('click', markAttendanceHandler);

                    // Show edit button for workers with a status other than 'Present' or 'Absent'
                    if (presentButton.style.display === 'none' && absentButton.style.display === 'none') {
                        editButton.style.display = 'inline-block';
                        editButton.addEventListener('click', () => {
                        editAttendance(cell);
                        });
                    }
                    });
                })
                .catch((error) => console.error('Error retrieving tasks:', error));
            };
    
        document.addEventListener('DOMContentLoaded', () => {
            tasksTableBody.addEventListener('click', handleButtonClick);
            fetchAndDisplayTasks();
    
            const editButtons = document.querySelectorAll('.edit-btn');
            editButtons.forEach(editButton => {
                const attendanceCell = editButton.closest('.attendance');
                editButton.addEventListener('click', () => {
                    editAttendance(attendanceCell);
                });
            });
        });

    </script>
</body>
</html>