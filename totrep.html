<!DOCTYPE html>
<html lang="en">
<head>
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@400;700&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/pent.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid" style="margin: 10px 20px;">
          <a class="navbar-brand" href="#">
            <img src="assets/img/logo.png" alt="Construct Eaze" style="width: 280px;">
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0"  style="margin-left: 15%;">
              
              <li class="nav-item">
                <a class="nav-link" href="#">Master</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Labour Management</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="pord.html">Purchase Management</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="todo.html">Site Activity</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="labrep.html">Report Generation</a>
              </li>
            </ul>
            <form class="d-flex" action="/login/logout" method="GET">
              <button class="btn" type="submit"><span class="txt">Logout</span></button>
            </form>
          </div>
        </div>
      </nav>

      <div class="row content" style="display: flex; width: 100%; height: 100%;" >
        <div class="col-lg-2">
          <div class="sidebar" style="height: 100%;">
            <nav class="nav flex-column" style="padding-top: 100px; ">
              <a class="nav-link active space" href="labrep.html">Labour Wise Report</a>
              <a class="nav-link space"  href="venrep.html">Vendor Wise Report</a>
              <a class="nav-link space" href="payrep.html">Payment Details Report</a>
              <a class="nav-link space" style="color: white !important; background-color: rgba(0, 0, 0, 0.2); border-left: 3px solid #F2D200;" href="#">Total Expenses Report</a>
              <a class="nav-link space" href="matrep.html">Material Wise Report</a>
              <a class="nav-link space" href="daterep.html">Date Wise Report</a>
              <a class="nav-link space" href="accst.html">Account Statement</a>
            </nav>
          </div>
        </div>
        <div class="col-lg-10">



            <div class="content-item rep" id="labore-wise">
          
                <div class="report-section" id="labour-report">
                  <h3>TOTAL EXPENSE REPORT</h3>

                  <div style="margin-top: 3.2%;">Start Date:</div>
                  <input type="date" id="startdate">
                  <br><br>
                  <div>End Date:</div>
                  <input type="date" id="enddate">
                  <br><br>

                  <form>
                    <input type="hidden" name="report_type" value="labour">
                    <div><button onclick="storeDates()" type="button" style="background-color: #242e82 !important; width:200px;">Download as PDF</button></div>
                    <div><button onclick="downloadExcel()" type="button"  style="background-color: #242e82 !important;width:200px; ">Download as Excel</button></div>
                    <!--<button onclick="generatePDF()">Confirm</button>-->
                </form>

              </div>
              
              </div>



          
        </div>


      </div>
      <script>
        function storeDates() {
            // Get the values of the "Start Date" and "End Date" inputs by their id names
            const startDateValue = document.getElementById('startdate').value;
            const endDateValue = document.getElementById('enddate').value;
    
            // Parse the start and end date strings to Date objects
            const startDate = new Date(startDateValue);
            const endDate = new Date(endDateValue);
    
            // Create an array to store the dates between the start and end dates
            const dateArray = [];
    
            // Loop through the dates and add them to the array
            let currentDate = new Date(startDate);
            currentDate.setDate(currentDate.getDate() + 1); // Skip the start date
            while (currentDate < endDate) {
                dateArray.push(currentDate.toISOString().split('T')[0]);
                currentDate.setDate(currentDate.getDate() + 1);
            }
    
            // Create a form element dynamically to trigger the download
            const form = document.createElement('form');
            form.action = '/prod/totdownload-pdf'; // Set the URL for PDF download
            form.method = 'POST';
    
            // Create an input field for dateArray
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'dateArray';
            input.value = JSON.stringify(dateArray); // Convert dateArray to JSON string
    
            // Add the input field to the form
            form.appendChild(input);
    
            // Add the form to the document and submit it to trigger the download
            document.body.appendChild(form);
            form.submit();
    
            console.log('Dates Between Start and End Date:', dateArray);
        }
    </script>
<script>
    function downloadExcel() {
    // Get the values of the "Start Date" and "End Date" inputs by their id names
    const startDateValue = document.getElementById('startdate').value;
    const endDateValue = document.getElementById('enddate').value;

    // Parse the start and end date strings to Date objects
    const startDate = new Date(startDateValue);
    const endDate = new Date(endDateValue);

    // Create an array to store the dates between the start and end dates
    const dateArray = [];

    // Loop through the dates and add them to the array
    let currentDate = new Date(startDate);
    currentDate.setDate(currentDate.getDate() + 1); // Skip the start date
    while (currentDate < endDate) {
    dateArray.push(currentDate.toISOString().split('T')[0]);
    currentDate.setDate(currentDate.getDate() + 1);
    }

    // Create a form element dynamically to trigger the download
    const form = document.createElement('form');
    form.action = '/prod/totdownload-excel'; // Set the URL for PDF download
    form.method = 'POST';

    // Create an input field for dateArray
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'dateArray';
    input.value = JSON.stringify(dateArray); // Convert dateArray to JSON string

    // Add the input field to the form
    form.appendChild(input);

    // Add the form to the document and submit it to trigger the download
    document.body.appendChild(form);
    form.submit();

    console.log('Dates Between Start and End Date:', dateArray);
    }
</script>
      
</body>
</html>


